

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Volume-based Monte Carlo Estimators &mdash; TARDIS v3.0.dev1</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Spectrum Generation with Virtual Packets" href="virtualpackets.html" />
    <link rel="prev" title="Line Interaction Treatments" href="lineinteraction.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> TARDIS
          

          
          </a>

          
            
            
              <div class="version">
                3.0.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/quickstart.html">Quickstart for TARDIS</a></li>
</ul>
<p class="caption"><span class="caption-text">Using TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../using/components/index.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using/interaction/index.html">Additional Interactivity</a></li>
</ul>
<p class="caption"><span class="caption-text">The Physics of TARDIS</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Monte Carlo Primer</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basicprinciples.html">Monte Carlo Radiative Transfer - Basic Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="discretization.html">Monte Carlo Discretization — Energy Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="propagation.html">Packet Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lineinteraction.html">Line Interaction Treatments</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Volume-based Monte Carlo Estimators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basic-principle">Basic Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#volume-based-estimators-in-tardis">Volume-based Estimators in TARDIS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="virtualpackets.html">Spectrum Generation with Virtual Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="sourceintegration.html">Direct integration of the radiation field</a></li>
<li class="toctree-l2"><a class="reference internal" href="randomsampling.html">Random Sampling Basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plasma/index.html">Plasma</a></li>
</ul>
<p class="caption"><span class="caption-text">Research with TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/index.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Team &amp; Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../team_and_governance/index.html">Team and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Development Roadmap</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">tardis</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zreferences.html">TARDIS Papers and useful References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TARDIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Monte Carlo Primer</a> &raquo;</li>
        
      <li>Volume-based Monte Carlo Estimators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/physics/montecarlo/estimators.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="volume-based-monte-carlo-estimators">
<h1>Volume-based Monte Carlo Estimators<a class="headerlink" href="#volume-based-monte-carlo-estimators" title="Permalink to this headline">¶</a></h1>
<p>An integral part of Monte Carlo radiative transfer calculations consists of
reconstructing macroscopic radiation field properties from the ensemble of
packet interaction histories. TARDIS uses volume-based Monte Carlo estimators
for this purpose. This concept was originally developed by <a class="bibtex reference internal" href="../../zreferences.html#lucy1999" id="id1">[Lucy99a]</a> and
successively refined, for example, by <a class="bibtex reference internal" href="../../zreferences.html#lucy1999a" id="id2">[Lucy99b]</a>, <a class="bibtex reference internal" href="../../zreferences.html#lucy2002" id="id3">[Lucy02]</a> and
<a class="bibtex reference internal" href="../../zreferences.html#lucy2003" id="id4">[Lucy03]</a>.</p>
<div class="section" id="basic-principle">
<h2>Basic Principle<a class="headerlink" href="#basic-principle" title="Permalink to this headline">¶</a></h2>
<p>The basic principle underlying volume-based estimators is best illustrated
by the example of reconstructing the mean radiation field energy density within
a certain control volume (in most cases, this will be a grid cell). A simple
approach would involve explicitly counting the number of Monte Carlo packets
which reside in the control volume at a certain time. Although being intuitive,
this approach suffers heavily from Monte Carlo shot noise, in particular in
situations in which only few (or even zero) packets reside in the control
volume when performing the counting.</p>
<p>The volume-based estimator approach addresses this weakness. It considers a
certain time interval <span class="math notranslate nohighlight">\(\Delta t\)</span> and accounts for all packets which at
any point during the control interval resided in the control volume. Each
packet then contributes to the total time and volume-averaged radiation field
energy density according to its energy weighted by the time it spent in the
control volume <span class="math notranslate nohighlight">\(\delta t\)</span> relative to the control interval <span class="math notranslate nohighlight">\(\Delta
t\)</span>:</p>
<div class="math notranslate nohighlight">
\[E = \frac{1}{\Delta V} \sum_i \varepsilon_i \frac{\delta t_i}{\Delta t}\]</div>
<p>This may be turned into the following estimator involving the trajectory
segment lengths <span class="math notranslate nohighlight">\(l_i\)</span></p>
<div class="math notranslate nohighlight">
\[E = \frac{1}{c \Delta V \Delta t} \sum_i \varepsilon_i l_i\]</div>
<p>by exploiting <span class="math notranslate nohighlight">\(l_i = \delta t_i c\)</span>. Compared to the simple counting
approach, the volume-based estimator will yield non-zero results as long as at
least one packet passed through the control volume. Additionally, as one packet
may generally contribute multiple times to the estimator (e.g. if it is
deflected by a scattering), these estimators typically suffer from less Monte
Carlo noise than simple counting reconstruction schemes.</p>
</div>
<div class="section" id="volume-based-estimators-in-tardis">
<h2>Volume-based Estimators in TARDIS<a class="headerlink" href="#volume-based-estimators-in-tardis" title="Permalink to this headline">¶</a></h2>
<p>Within TARDIS, volume-based estimators are used to reconstruct the mean
intensity and the mean frequency of the radiation field (see also
<a class="bibtex reference internal" href="../../zreferences.html#kerzendorf2014" id="id5">[KerzendorfSim14]</a>). An estimator for the former is easily formulated by
using the fundamental relation <span class="math notranslate nohighlight">\(J = \frac{c}{4\pi} E\)</span> and the energy density
estimator derived above:</p>
<div class="math notranslate nohighlight">
\[J = \frac{1}{4\pi \Delta V \Delta t}\sum_i \varepsilon_i l_i D_{\mu}\]</div>
<p>An intensity-weighted estimate for the mean frequency is obtained from</p>
<div class="math notranslate nohighlight">
\[\bar \nu = \frac{1}{4\pi \Delta V \Delta t}\sum_i \varepsilon_i \nu_i l_i D_{\mu}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compared to the estimators derived in the previous section, the ones
presented here involve a relativistic factor, <span class="math notranslate nohighlight">\(D_{\mu} = (1 - \beta
\mu)\)</span>, which ensures the correct frame transformation behaviour of the
estimators (to first order in <span class="math notranslate nohighlight">\(v/c\)</span>).</p>
</div>
<p>Using the estimators just derived the radiation temperature (which should be
interpreted as a colour temperature) of the radiation field,</p>
<div class="math notranslate nohighlight">
\[T_{\mathrm{R}} = \frac{h}{k_{\mathrm{B}}} \frac{\pi^4}{360 \zeta(5)} \frac{\bar \nu}{J}\]</div>
<p>may be derived. The normalization constants, involving Riemann’s zeta function,
are a consequence from the definition of this colour temperature: This should
be the temperature of a black-body radiation field whose mean frequency is
equal to the one reconstructed from the Monte Carlo simulation. With the
temperature determined, the dilution factor, describing the deviation of the
radiation field from a thermal field with the same colour temperature may be calculated</p>
<div class="math notranslate nohighlight">
\[W = \frac{\pi J}{\sigma_{\mathrm{R}} T_{\mathrm{R}}^4}\]</div>
<p>These two quantities, <span class="math notranslate nohighlight">\(T_{\mathrm{R}}\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are vital for the
calculation of the plasma state of the ejecta (see <a class="reference internal" href="../plasma/index.html#plasma-calculations"><span class="std std-ref">Plasma Calculations</span></a>).</p>
<p>Finally, TARDIS also reconstructs the mean intensity of the radiation field in
the blue wing of each line transition <span class="math notranslate nohighlight">\(l \rightarrow u\)</span>, which is used in
the Macro Atom treatment and in the ionisation calculation.</p>
<div class="math notranslate nohighlight">
\[J_{lu}^b = \frac{1}{4\pi \Delta V \Delta t} \frac{t_{\mathrm{exp}}}{c} \sum_i \frac{\varepsilon_i}{\nu_{lu}} D_{\mu}.\]</div>
<p>The summation here only involves packets which passed through the Sobolev point
(see <a class="reference internal" href="propagation.html#propagation"><span class="std std-ref">Propagation</span></a>) of the transition. For a derivation of this
estimator, in particular, for a motivation of the expansion factor involving
the time since explosion <span class="math notranslate nohighlight">\(t_{\mathrm{exp}}\)</span>, we refer to
<a class="bibtex reference internal" href="../../zreferences.html#lucy2003" id="id6">[Lucy03]</a>, section 6.2.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="virtualpackets.html" class="btn btn-neutral float-right" title="Spectrum Generation with Virtual Packets" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="lineinteraction.html" class="btn btn-neutral float-left" title="Line Interaction Treatments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2013-2021, TARDIS collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>