

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Line Interaction Treatments &mdash; TARDIS v3.0.dev1</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Volume-based Monte Carlo Estimators" href="estimators.html" />
    <link rel="prev" title="Packet Propagation" href="propagation.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> TARDIS
          

          
          </a>

          
            
            
              <div class="version">
                3.0.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/quickstart.html">Quickstart for TARDIS</a></li>
</ul>
<p class="caption"><span class="caption-text">Using TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../using/components/index.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using/interaction/index.html">Additional Interactivity</a></li>
</ul>
<p class="caption"><span class="caption-text">The Physics of TARDIS</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Monte Carlo Primer</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basicprinciples.html">Monte Carlo Radiative Transfer - Basic Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="discretization.html">Monte Carlo Discretization — Energy Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="propagation.html">Packet Propagation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Line Interaction Treatments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#resonant-scattering">Resonant Scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#downbranching">Downbranching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macro-atom-scheme">Macro Atom Scheme</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparison">Comparison</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="estimators.html">Volume-based Monte Carlo Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="virtualpackets.html">Spectrum Generation with Virtual Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="sourceintegration.html">Direct integration of the radiation field</a></li>
<li class="toctree-l2"><a class="reference internal" href="randomsampling.html">Random Sampling Basics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plasma/index.html">Plasma</a></li>
</ul>
<p class="caption"><span class="caption-text">Research with TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../research/index.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Team &amp; Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../team_and_governance/index.html">Team and Governance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CODE_OF_CONDUCT.html">Code of Conduct</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Development Roadmap</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">tardis</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zreferences.html">TARDIS Papers and useful References</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TARDIS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Monte Carlo Primer</a> &raquo;</li>
        
      <li>Line Interaction Treatments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/physics/montecarlo/lineinteraction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="line-interaction-treatments">
<h1>Line Interaction Treatments<a class="headerlink" href="#line-interaction-treatments" title="Permalink to this headline">¶</a></h1>
<p>TARDIS currently offers different ways to handle line interactions, which may be
activated via the YAML configuration file. Independently of the chosen
treatment, a number of steps are always carried out when a Monte Carlo packet
performs a line interaction. Since TARDIS adopts the indivisible energy packet
formalism (see <a class="reference internal" href="discretization.html"><span class="doc">Discretization</span></a>), the packet will have the
same energy in the co-moving frame after (f for final) the line interaction as
before (i for initial). Thus, after accounting for the frame transformations,</p>
<div class="math notranslate nohighlight">
\[\varepsilon_f = \varepsilon_i \frac{1 - \beta \mu_i}{1 - \beta \mu_f}\]</div>
<p>holds. Also, TARDIS treats that the re-emission of the line interaction
as an isotropic process. Thus,</p>
<div class="math notranslate nohighlight">
\[\mu_f = 2 z - 1.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the Sobolev theory, the re-emission direction is given by the so-called
Sobolev escape fraction, with is in general non-isotropic. However, in the
special case of homologous expansion, isotropy is retained.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Strictly speaking, the re-mission process occurs in the local co-moving
frame. Thus, the so called angle aberration effect should be taken into
account when transforming into the lab frame. However, TARDIS, currently
neglects this effect.</p>
</div>
<p>Essentially, the different line interaction treatments only determine how the
frequency of the packet after the line interaction is determined.</p>
<div class="section" id="resonant-scattering">
<h2>Resonant Scattering<a class="headerlink" href="#resonant-scattering" title="Permalink to this headline">¶</a></h2>
<p>The simplest line interaction mode assumes that all interactions with atomic
line transitions occur resonantly. This implies that in the co-moving frame the
emergent packet frequency is equal to the incident one. Again accounting for
the Doppler factors due to the frame transformations between co-moving and lab
frame, the post-interaction frequency is given by</p>
<div class="math notranslate nohighlight">
\[\nu_f  = \nu_i \frac{1 - \beta \mu_i}{1 - \beta \mu_f}\]</div>
</div>
<div class="section" id="downbranching">
<h2>Downbranching<a class="headerlink" href="#downbranching" title="Permalink to this headline">¶</a></h2>
<p>The so-called downbranching scheme, introduced by <a class="bibtex reference internal" href="../../zreferences.html#lucy1999a" id="id1">[Lucy99b]</a>, is an
elegant approach to approximately account for fluorescence effects. In this
scheme, the packet is not re-emitted in the same transitions as it was absorbed
in. Instead, it now can emerge from any line transition linking the activated
upper energy level to a lower one. For any specific line interaction event, the
re-emission channel is probabilistically selected according to the branching
ratios of the different allowed de-excitation transitions. For more details
about the downbranching scheme, we refer to <a class="bibtex reference internal" href="../../zreferences.html#lucy1999a" id="id2">[Lucy99b]</a> and
<a class="bibtex reference internal" href="../../zreferences.html#kerzendorf2014" id="id3">[KerzendorfSim14]</a>.</p>
</div>
<div class="section" id="macro-atom-scheme">
<h2>Macro Atom Scheme<a class="headerlink" href="#macro-atom-scheme" title="Permalink to this headline">¶</a></h2>
<p>Finally, as the most sophisticated line interaction treatment, a simplified
version of the Macro Atom scheme of <a class="bibtex reference internal" href="../../zreferences.html#lucy2002" id="id4">[Lucy02]</a> and <a class="bibtex reference internal" href="../../zreferences.html#lucy2003" id="id5">[Lucy03]</a> is
implemented in TARDIS. This approach provides a more accurate representation of
fluorescence processes and multi-line effects. Once a Monte Carlo packet is
absorbed in a certain line transition (macro atom activation), an arbitrary
number of internal jumps up and downwards may be performed. One may think of
them as changing the energy level which is excited. At any point during this
process, there is the chance that the internal jump procedure terminates and
that the packet is re-emitted in a transition linking the currently excited
upper energy level to a lower one (macro atom deactivation). Again, all
involved processes are governed by probabilities reflecting the different line
transition strengths, radiative emission and absorption processes. More details
about the implementation of the Macro Atom scheme in TARDIS is provided
<a class="reference internal" href="../plasma/macroatom.html#macroatom"><span class="std std-ref">here</span></a>. For more background information and
an in-depth derivation of the scheme, we refer to <a class="bibtex reference internal" href="../../zreferences.html#lucy2002" id="id6">[Lucy02]</a> and
<a class="bibtex reference internal" href="../../zreferences.html#lucy2003" id="id7">[Lucy03]</a>.</p>
</div>
<div class="section" id="comparison">
<h2>Comparison<a class="headerlink" href="#comparison" title="Permalink to this headline">¶</a></h2>
<p>The different levels of sophistication are illustrated in the following plot,
taken from <a class="bibtex reference internal" href="../../zreferences.html#kerzendorf2014" id="id8">[KerzendorfSim14]</a> and showing the incident wavelength versus the
emergent wavelength of Monte Carlo packets in line interactions. The left panel
shows the situation in the resonant scatter mode, the middle one for the
downbranching scheme and the right one the macro atom results.</p>
<a class="reference internal image-reference" href="../../_images/scatter_downbranch_ma.png"><img alt="../../_images/scatter_downbranch_ma.png" src="../../_images/scatter_downbranch_ma.png" style="width: 700px;" /></a>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="estimators.html" class="btn btn-neutral float-right" title="Volume-based Monte Carlo Estimators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="propagation.html" class="btn btn-neutral float-left" title="Packet Propagation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2013-2021, TARDIS collaboration.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>